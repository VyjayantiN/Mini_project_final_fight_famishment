{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="en">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Analytics Dashboard - This is an example dashboard created using build-in elements and components.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, shrink-to-fit=no" />
    <meta name="description" content="This is an example dashboard created using build-in elements and components.">
    <meta name="msapplication-tap-highlight" content="no">
    <link href="https://demo.dashboardpack.com/architectui-html-free/main.css" rel="stylesheet">
</head>
<body>
    <div class="app-container app-theme-white body-tabs-shadow fixed-sidebar fixed-header container-fluid">             
        <div class="app-main__outer">
            <div class="app-main__inner">
                <!-- Top row progress bar -->
                <div class="row">
                    <div class="col-md-6 col-lg-3">
                        <div class="card-shadow-danger mb-3 widget-chart widget-chart2 text-left card">
                            <div class="widget-content">
                                <div class="widget-content-outer">
                                    <div class="widget-content-wrapper">
                                        <div class="widget-content-left pr-2 fsize-1">
                                            <div class="widget-numbers mt-0 fsize-3 text-danger">{{ total_proteins }}g</div>
                                        </div>
                                        <div class="widget-content-right w-100">
                                            <div class="progress-bar-xs progress">
                                                <div class="progress-bar bg-danger" role="progressbar" aria-valuenow="{{ total_proteins }}" aria-valuemin="0" aria-valuemax="500" style="width: {{ protein_percentage }}%;"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="widget-content-left fsize-1">
                                        <div class="text-muted opacity-6">Protein</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <div class="card-shadow-success mb-3 widget-chart widget-chart2 text-left card">
                            <div class="widget-content">
                                <div class="widget-content-outer">
                                    <div class="widget-content-wrapper">
                                        <div class="widget-content-left pr-2 fsize-1">
                                            <div class="widget-numbers mt-0 fsize-3 text-success">{{ total_carbohydrates }}g</div>
                                        </div>
                                        <div class="widget-content-right w-100">
                                            <div class="progress-bar-xs progress">
                                                <div class="progress-bar bg-success" role="progressbar" aria-valuenow="{{ total_carbohydrates }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ carbohydrate_percentage }}%;"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="widget-content-left fsize-1">
                                        <div class="text-muted opacity-6">Carbohydrate</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <div class="card-shadow-warning mb-3 widget-chart widget-chart2 text-left card">
                            <div class="widget-content">
                                <div class="widget-content-outer">
                                    <div class="widget-content-wrapper">
                                        <div class="widget-content-left pr-2 fsize-1">
                                            <div class="widget-numbers mt-0 fsize-3 text-warning">{{ total_fats }}g</div>
                                        </div>
                                        <div class="widget-content-right w-100">
                                            <div class="progress-bar-xs progress">
                                                <div class="progress-bar bg-warning" role="progressbar" aria-valuenow="{{ total_fats }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ fat_percentage }}%;"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="widget-content-left fsize-1">
                                        <div class="text-muted opacity-6">Fats</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <div class="card-shadow-warning mb-3 widget-chart widget-chart2 text-left card">
                            <div class="widget-content">
                                <div class="widget-content-outer">
                                    <div class="widget-content-wrapper">
                                        <div class="widget-content-left pr-2 fsize-1">
                                            <div class="widget-numbers mt-0 fsize-3 text-info">{{ bmi }}</div>
                                        </div>
                                        <div class="widget-content-right w-100">
                                            <div class="progress-bar-xs progress">
                                                <div class="progress-bar bg-info" role="progressbar" aria-valuenow="{{ bmi }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ bmi }}%;"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="widget-content-left fsize-1">
                                        <div class="text-muted opacity-6">BMI</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End of top row progress bar -->
                
                <!-- Row with charts -->
                <div class="row">
                    <div class="col-md-6">
                        
                        <div class="card my-0 widget-chart widget-chart2 text-left ">
                            
                            <div class="widget-chat-wrapper-outer">
                                <div class="widget-chart-wrapper widget-chart-wrapper-lg m-0">
                                    <div id="pie_chart" style="width: 600px; height: 500px;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            
                            <div class="tab-content" style="padding-top:15px; padding-left:10px;">
                                <div class="tab-pane fade active show" id="tab-eg-55">
                                   
                                    <div>
                                        <h3 style="font-weight:bold; margin-left:5px; color:black;">Predicted BMI after 30 days: {{ predicted_bmi }}</h3>
                                        {% if bmi < 18.5 %}
                                            <h4 style="font-weight:bold; margin-left:5px; color:red;">
                                                You are underweight. Consume nutritious food.
                                                <a href="child_bmi"><button type="button" class="btn btn-dark">See Recipes</button></a>
                                            </h4>
                                        {% elif bmi > 25.5 %}
                                            <h4 style="font-weight:bold; margin-left:5px; color:red;">
                                                You are overweight. Exercise regularly.
                                                <a href="child_bmi"><button type="button" class="btn btn-dark">See Recipes</button></a>
                                            </h4>
                                        {% else %}
                                            <h4 style="font-weight:bold; margin-left:5px; color:green;">
                                                You are healthy. Maintain your lifestyle.
                                                <a href="child_bmi"><button type="button" class="btn btn-dark">See Recipes</button></a>
                                            </h4>
                                        {% endif %}
                                    </div>
                                    
                                    
                                    
                                   
                                    
                                    <div class="widget-chart p-3">
                                        <div style="height: 350px">
                                            <canvas id="line-chart"></canvas>
                                        </div>
                                    </div>
 



                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End of row with charts -->
            </div>
        </div>
    </div>
</body>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
    // Load the Visualization API and the corechart package.
    google.charts.load('current', {'packages':['corechart']});

    // Set a callback to run when the Google Visualization API is loaded.
    google.charts.setOnLoadCallback(drawChart);

    // Callback function to draw the pie chart.
    function drawChart() {
        // Define the data for the pie chart.
        var data = google.visualization.arrayToDataTable([
            ['Nutrient', 'Percentage'],
            ['Protein', {{ protein_percentage2 }}],
            ['Carbohydrate', {{ carbohydrate_percentage2 }}],
            ['Fat', {{ fat_percentage2 }}],
            ['Vitamin', {{ vitamin_percentage2 }}],
            ['Mineral', {{ mineral_percentage2 }}]
        ]);

        // Set options for the pie chart.
        var options = {
            title: 'Nutrient Distribution',
            titleTextStyle: { fontSize: 20 },
            width: 600,
            height: 500
        };

        // Instantiate and draw the pie chart.
        var chart = new google.visualization.PieChart(document.getElementById('pie_chart'));
        chart.draw(data, options);
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Get the canvas element
    var ctx = document.getElementById('line-chart').getContext('2d');

    // Define the current BMI and predicted BMI
    var currentBMI = {{ bmi }};
    var predictedBMI = {{ predicted_bmi }};

    // Calculate the lower and upper limits for the y-axis scale
    var lowerLimit = currentBMI - 2;
    var upperLimit = currentBMI + 2;

    // Define the data
    var data = {
        labels: ['Day 0', 'Day 30'],
        datasets: [{
            label: 'Predicted BMI',
            data: [currentBMI, predictedBMI],
            backgroundColor: 'rgba(255, 99, 132, 0.2)',
            borderColor: 'rgba(255, 99, 132, 1)',
            borderWidth: 1,
            fill: false
        }]
    };

    // Define the options
    var options = {
        scales: {
            y: {
                min: lowerLimit,
                max: upperLimit,
                beginAtZero: false
            }
        }
    };

    // Create an array to hold interpolated BMI values
    var interpolatedBMI = [];

    // Calculate the slope
    var slope = (predictedBMI - currentBMI) / 30;

    // Populate the interpolatedBMI array
    for (var i = 0; i <= 30; i++) {
        interpolatedBMI.push(currentBMI + slope * i);
    }

    // Add the interpolated data to the dataset
    data.datasets[0].data = interpolatedBMI;
    data.labels = Array.from(Array(31).keys()).map(day => `Day ${day}`); // Update labels for all 31 days

    // Create the line chart
    var lineChart = new Chart(ctx, {
        type: 'line',
        data: data,
        options: options
    });
</script>



</html>
